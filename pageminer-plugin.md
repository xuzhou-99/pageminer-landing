# 浏览器数据提取插件产品规划与设计文档

## 一、产品概述

### 1.1 产品名称

智能网页数据提取助手（Smart Web Extractor）

### 1.2 核心价值

帮助用户**快速、可视化、低门槛地从任意网页中提取结构化数据**，并支持自动应用、规则共享、导出与自动同步等功能。

### 1.3 目标用户

- 数据分析师、爬虫工程师
- 产品经理、运营人员
- 需要定期采集网页数据的个人或企业用户
- 无编程能力但有数据提取需求的普通用户

---

## 二、产品功能设计

### 2.1 MVP 核心功能

1. **可视化选择数据元素**
    - 鼠标悬停高亮元素，点击选择字段
    - 自动识别列表结构和相似节点
2. **字段命名与规则生成**
    - 用户可手动为每个字段命名
    - 插件自动生成 CSS/XPath/DOM 路径规则
3. **规则保存与自动应用**
    - 基于 URL 或域名存储规则
    - 再次访问网页时自动提取并展示数据
4. **数据预览与导出**
    - 表格形式展示已提取数据
    - 支持导出 CSV/Excel/JSON 格式
5. **本地存储与数据管理**
    - 管理已创建的提取任务与规则
    - 支持编辑、重命名、删除
6. **基础规则分享功能**
    - 生成规则 JSON，用户可手动分享
    - 支持通过链接导入规则

---

### 2.2 进阶功能（MVP 后）

1. **规则云同步与账户系统**
    - 用户登录后支持规则云端同步与版本控制
2. **规则市场（Marketplace）**
    - 用户可上传规则，公开分享或出售
3. **高级提取逻辑支持**
    - 支持点击加载、懒加载内容处理
    - 支持正则表达式、文本清洗规则配置
4. **定时任务与自动化**
    - 定时抓取特定网页并存档数据
    - 邮件/Slack/钉钉通知更新
5. **插件内脚本扩展能力**
    - 支持用户自定义处理脚本（例如 JS 函数）
6. **AI 智能规则生成**
    - 利用 GPT 接口，根据用户选择智能生成提取规则

---

## 三、技术架构设计

### 3.1 前端模块

- 插件弹窗页（popup.html + React/Vue）
- 内容脚本（content-script.js）负责网页交互与元素选择
- 背景脚本（background.js）处理数据存储与同步

### 3.2 核心技术

- 网页结构解析：DOM、XPath、CSS Selector、Shadow DOM 支持
- 高亮与选择：MutationObserver、事件委托
- 数据结构识别：树结构相似性算法、HTML table 自动提取
- 存储：Chrome storage（MVP），IndexedDB，远程云 API（高级）

### 3.3 安全设计

- 插件权限最小化
- 不收集隐私信息，所有提取规则与数据默认保存在本地

---

## 四、用户体验设计

### 4.1 插件操作流程

1. 点击插件按钮，启动提取流程
2. 鼠标指向网页元素，点击选择字段
3. 命名字段，系统生成规则
4. 预览提取数据
5. 保存规则、导出数据

### 4.2 UI设计要点

- 页面结构清晰，操作引导明确
- 高亮与交互需保持响应迅速
- 配色简洁（建议浅色背景 + 高对比色高亮）

---

## 五、MVP 项目规划

### 5.1 阶段目标

| 阶段 | 时间周期 | 目标 |
| --- | --- | --- |
| 需求确认 | 第1周 | 明确插件目标、核心功能、用户流程 |
| MVP 开发 | 第2~4周 | 实现选择元素、生成规则、保存与导出 |
| 内测收集反馈 | 第5周 | 内部测试并优化体验 |
| 发布商店 | 第6周 | 发布至 Chrome Web Store，支持基础分享 |

### 5.2 MVP 不包含

- 账户系统、云同步、AI 规则生成、定时抓取

---

## 六、运营与推广规划

### 6.1 推广渠道

- 内容营销：知乎、B 站视频、微信公众号发布使用教程
- 插件市场优化（ASO）：撰写高质量插件描述和截图
- 合作扩展：与数据分析、办公自动化类插件联动推广
- 社区运营：创建交流群、用户社群互动

### 6.2 变现模式

| 模式 | 说明 |
| --- | --- |
| Freemium | 基础功能永久免费，导出数据、云同步、定时任务等高级功能订阅付费 |
| 规则市场分成 | 用户发布高质量规则，平台抽成 10%~30% |
| 团队/企业版订阅 | 提供团队协作、统一管理、多账号等企业版功能 |

---

## 七、风险与挑战

| 问题 | 风险点 | 应对策略 |
| --- | --- | --- |
| 网页结构多样性 | 高复杂度页面难以识别提取 | 迭代规则算法 + 用户修正机制 |
| 用户操作学习成本 | 部分用户不熟悉网页结构 | 教程引导 + 智能默认规则 |
| 法律合规问题 | 抓取数据可能涉及版权或隐私 | 提醒用户自担风险，并标注不用于违法用途 |
| 插件权限审核 | Chrome Web Store 审核严格 | 权限最小化设计 + 合规文案 |

---

## 八、后续演进路线

1. **v1.0（MVP 发布）**：可视化提取 + 本地规则保存 + 数据导出
2. **v1.5**：支持规则分享、跨页提取、字段数据清洗
3. **v2.0**：账户系统、规则云同步、插件 AI 助手
4. **v3.0+**：规则市场、团队协作、自动化任务调度

---

## 九、总结

这是一个结合数据提取刚需 + 可视化交互创新的插件项目，具备明确的用户价值、较强的技术可行性和广阔的变现空间。MVP 阶段需聚焦用户最核心痛点，后续逐步通过规则市场和智能化演进形成长期竞争力。



# PageMiner JavaScript 功能改进总结

## 🎯 改进目标

本次改进旨在优化三个主要页面的JavaScript功能，提升用户体验、增强错误处理、改进交互逻辑，并与新的HTML/CSS结构保持一致。

## ✨ 改进范围

### 1. **ruleManager.js** ✅ 已完成
- 规则管理页面的功能优化
- 改进的空状态处理
- 增强的用户交互体验

### 2. **viewDataManager.js** ✅ 已完成
- 数据查看页面的功能升级
- 优化的表格渲染逻辑
- 改进的分页和状态管理

### 3. **popup.js** ✅ 已完成
- 弹窗界面的功能增强
- 完善的错误处理机制
- 优化的用户体验

## 🔧 具体改进内容

### ruleManager.js 改进

#### 新增功能
- **加载状态管理**: 显示/隐藏加载状态，防止重复操作
- **空状态处理**: 友好的空规则提示和引导
- **字段删除**: 支持删除单个字段
- **选择器复制**: 点击字段选择器可复制到剪贴板
- **规则操作区域**: 独立的规则操作按钮区域

#### 用户体验优化
- **输入验证**: 改进的输入验证和错误提示
- **状态恢复**: 操作失败时自动恢复原状态
- **确认对话框**: 删除操作的安全确认
- **实时反馈**: 即时的操作结果反馈

#### 代码结构优化
- **函数模块化**: 将复杂逻辑拆分为独立函数
- **错误处理**: 完善的try-catch错误处理
- **事件委托**: 优化的事件处理机制
- **异步操作**: 改进的异步操作管理

### viewDataManager.js 改进

#### 新增功能
- **加载状态管理**: 显示/隐藏加载状态
- **表格占位符**: 友好的初始状态提示
- **空数据状态**: 专门的无数据提示界面
- **表格行样式**: 交替行颜色和悬停效果
- **文本展开**: 点击截断文本可展开查看完整内容

#### 用户体验优化
- **状态管理**: 改进的控件状态切换
- **分页优化**: 优化的分页信息显示
- **表格交互**: 更好的表格交互体验
- **错误处理**: 完善的错误处理和用户提示

#### 代码结构优化
- **函数重构**: 重新组织函数结构
- **状态管理**: 改进的状态管理逻辑
- **事件处理**: 优化的事件监听器组织
- **响应式支持**: 更好的移动端支持

### popup.js 改进

#### 新增功能
- **按钮状态管理**: 防止重复点击和操作
- **错误提示系统**: 美观的错误提示界面
- **成功消息**: 操作成功的反馈提示
- **权限检查**: 扩展权限验证
- **键盘快捷键**: 支持数字键快捷操作

#### 用户体验优化
- **加载状态**: 按钮的加载状态显示
- **悬停效果**: 按钮悬停动画效果
- **错误处理**: 完善的错误捕获和处理
- **用户引导**: 友好的操作引导提示

#### 代码结构优化
- **异步处理**: 改进的异步操作管理
- **错误边界**: 全局错误处理机制
- **事件管理**: 优化的事件监听器
- **代码组织**: 清晰的函数组织结构

## 🎨 交互体验提升

### 视觉反馈
- **加载状态**: 按钮和界面的加载状态指示
- **悬停效果**: 丰富的悬停动画和状态变化
- **状态切换**: 平滑的状态切换动画
- **错误提示**: 美观的错误和成功消息提示

### 操作反馈
- **即时反馈**: 操作结果的即时反馈
- **状态恢复**: 失败操作的自动状态恢复
- **确认对话框**: 危险操作的安全确认
- **进度指示**: 长时间操作的进度指示

### 用户引导
- **空状态提示**: 友好的空数据状态引导
- **操作说明**: 清晰的操作说明和提示
- **错误指导**: 有用的错误解决建议
- **快捷键支持**: 便捷的键盘操作支持

## 🔒 错误处理改进

### 异常捕获
- **全局错误**: 全局错误和Promise拒绝处理
- **操作错误**: 具体操作的错误处理
- **网络错误**: 网络请求的错误处理
- **权限错误**: 扩展权限的错误处理

### 用户提示
- **错误消息**: 用户友好的错误提示
- **解决建议**: 具体的错误解决建议
- **状态恢复**: 自动的错误状态恢复
- **重试机制**: 失败操作的重试建议

### 日志记录
- **错误日志**: 详细的错误日志记录
- **操作日志**: 重要操作的日志记录
- **调试信息**: 开发调试的详细信息
- **性能监控**: 操作性能的监控记录

## 📱 响应式支持

### 移动端优化
- **触摸友好**: 触摸设备的友好交互
- **布局适配**: 小屏幕的布局适配
- **操作简化**: 移动端的操作简化
- **性能优化**: 移动端的性能优化

### 自适应设计
- **断点适配**: 不同屏幕尺寸的断点适配
- **组件响应**: 组件的响应式行为
- **交互适配**: 不同设备的交互适配
- **样式调整**: 响应式的样式调整

## 🚀 性能优化

### 渲染优化
- **DOM操作**: 优化的DOM操作策略
- **事件委托**: 高效的事件处理机制
- **异步加载**: 异步数据加载和渲染
- **状态缓存**: 合理的状态缓存策略

### 内存管理
- **事件清理**: 及时的事件监听器清理
- **对象回收**: 合理的对象生命周期管理
- **内存泄漏**: 防止内存泄漏的机制
- **资源释放**: 及时的资源释放

## 🔮 未来改进方向

### 功能增强
- **数据验证**: 更完善的数据验证机制
- **批量操作**: 支持批量数据处理
- **搜索过滤**: 高级搜索和过滤功能
- **数据导出**: 更多格式的数据导出

### 技术升级
- **TypeScript**: 类型安全的代码重构
- **状态管理**: 现代化的状态管理方案
- **组件化**: 组件化的代码组织
- **测试覆盖**: 完善的测试覆盖

### 用户体验
- **个性化**: 用户个性化设置
- **快捷操作**: 更多的快捷操作支持
- **操作历史**: 操作历史记录功能
- **智能提示**: 智能的操作提示

## 📝 维护说明

### 代码规范
- **命名规范**: 统一的函数和变量命名
- **注释规范**: 完整的代码注释
- **错误处理**: 统一的错误处理模式
- **异步处理**: 标准的异步操作处理

### 测试策略
- **单元测试**: 关键功能的单元测试
- **集成测试**: 页面功能的集成测试
- **用户测试**: 真实用户的使用测试
- **性能测试**: 性能指标的监控测试

### 版本管理
- **功能分支**: 新功能的功能分支开发
- **代码审查**: 严格的代码审查流程
- **版本发布**: 规范的版本发布流程
- **回滚机制**: 快速的问题回滚机制

---

**总结**: 本次JavaScript改进成功提升了PageMiner插件的功能完整性、用户体验和代码质量。通过完善的错误处理、优化的交互逻辑和增强的功能特性，显著提升了插件的稳定性和易用性。


# PageMiner 页面布局优化和消息框组件改进总结

## 🎯 改进目标

本次改进旨在优化PageMiner插件的页面布局，让界面更加紧凑美观，并设计一套统一的消息框组件系统来替换原生的prompt和confirm，提升整体用户体验。

## ✨ 改进范围

### 1. **页面布局优化** ✅ 已完成
- ruleManager页面布局紧凑化
- viewDataManager页面布局紧凑化
- 减少不必要的空白空间

### 2. **消息框组件系统** ✅ 已完成
- 自定义确认框组件
- 自定义输入框组件
- 自定义提示框组件
- 统一的设计风格

## 🔧 具体改进内容

### 页面布局优化

#### ruleManager 页面
- **容器宽度**: 从1200px调整为1000px
- **页面头部**: 内边距从30px调整为20px，标题字号从32px调整为24px
- **操作栏**: 内边距从20px调整为16px，下边距从30px调整为20px
- **规则卡片**: 内边距从20px调整为16px，下边距从20px调整为16px
- **字段列表**: 最大高度从300px调整为250px
- **输入框**: 内边距和字号适当减小
- **按钮**: 内边距和字号适当减小
- **开关**: 尺寸从60x28px调整为50x24px

#### viewDataManager 页面
- **容器宽度**: 从1400px调整为1200px
- **页面头部**: 内边距从30px调整为20px，标题字号从32px调整为24px
- **控制面板**: 内边距从24px调整为18px，下边距从30px调整为20px
- **数据容器**: 下边距从30px调整为20px
- **表格容器**: 最小高度从400px调整为350px
- **表格**: 单元格内边距从16px调整为12px，字号从14px调整为13px
- **分页**: 内边距从20px调整为16px，下边距从20px调整为15px

### 消息框组件系统

#### 核心功能
- **confirm()**: 美观的确认对话框，支持自定义按钮文本和图标
- **prompt()**: 美观的输入对话框，支持多种输入类型
- **alert()**: 美观的提示对话框，支持自动关闭
- **select()**: 美观的选择对话框，支持单选和多选

#### 设计特性
- **现代化设计**: 圆角、阴影、渐变等现代UI元素
- **动画效果**: 淡入淡出、滑入滑出等平滑动画
- **响应式布局**: 支持移动端和桌面端
- **主题一致**: 与PageMiner整体设计风格保持一致
- **图标系统**: 丰富的emoji图标支持

#### 技术特性
- **Promise API**: 完全异步，支持async/await
- **类型支持**: 支持text、textarea、select等多种输入类型
- **验证支持**: 内置必填字段验证
- **自动聚焦**: 输入框自动获得焦点
- **键盘支持**: 支持Enter和Escape键操作

## 🎨 设计风格统一

### 色彩方案
- **主色调**: 蓝色渐变 (#3b82f6 → #2563eb)
- **成功色**: 绿色渐变 (#10b981 → #059669)
- **危险色**: 红色渐变 (#ef4444 → #dc2626)
- **信息色**: 蓝色渐变 (#3b82f6 → #2563eb)
- **中性色**: 灰色系 (#f8fafc, #e2e8f0, #64748b)

### 设计元素
- **圆角**: 8px-12px 统一圆角设计
- **阴影**: 多层次阴影系统，营造深度感
- **渐变**: 现代化渐变背景和按钮
- **动画**: 平滑过渡和悬停效果
- **图标**: 统一的emoji图标系统

### 字体系统
- **字体栈**: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto
- **字重**: 400(常规), 500(中等), 600(半粗), 700(粗体)
- **字号**: 11px-24px 的层次化字号系统

## 📱 响应式设计

### 断点设置
- **桌面端**: > 1024px
- **平板端**: 768px - 1024px
- **移动端**: < 768px

### 适配策略
- 弹性布局和网格系统
- 字体大小和间距的响应式调整
- 按钮和控件的移动端优化
- 触摸友好的交互设计

## 🔄 使用方式

### 基本用法
```javascript
// 确认对话框
const confirmed = await confirm('确认删除？', '删除确认', {
    confirmText: '确认删除',
    cancelText: '取消',
    type: 'danger',
    icon: '🗑️'
});

// 输入对话框
const input = await prompt('请输入名称', '名称输入', {
    defaultValue: '',
    placeholder: '请输入...',
    type: 'text',
    required: true
});

// 提示对话框
await alert('操作成功', '成功提示', {
    type: 'success',
    icon: '✅',
    autoClose: true,
    duration: 3000
});

// 选择对话框
const selected = await select('请选择选项', ['选项1', '选项2', '选项3'], '选择', {
    defaultValue: '选项1',
    multiple: false
});
```

### 高级配置
```javascript
// 自定义按钮文本和图标
await confirm('确认操作？', '操作确认', {
    confirmText: '执行操作',
    cancelText: '取消操作',
    type: 'warning',
    icon: '⚠️'
});

// 自动关闭的提示
await alert('操作完成', '完成提示', {
    type: 'success',
    icon: '✅',
    autoClose: true,
    duration: 2000
});

// 必填输入框
const value = await prompt('请输入内容', '内容输入', {
    type: 'textarea',
    placeholder: '请输入详细内容...',
    required: true
});
```

## 🚀 性能优化

### 渲染优化
- 硬件加速的CSS动画
- 优化的阴影和模糊效果
- 合理的重绘和重排策略

### 用户体验
- 快速响应的交互反馈
- 流畅的动画过渡
- 直观的视觉层次

## 🔮 未来改进方向

### 功能增强
- 更多输入类型支持（日期、时间、颜色等）
- 自定义验证规则
- 批量操作支持
- 拖拽排序功能

### 技术升级
- TypeScript类型支持
- 组件化重构
- 主题系统
- 国际化支持

### 用户体验
- 快捷键支持
- 操作历史记录
- 智能提示系统
- 个性化设置

## 📝 维护说明

### 样式规范
- 遵循BEM命名规范
- 使用语义化的类名
- 保持样式的模块化
- 统一的注释风格

### 代码组织
- 按功能模块分组
- 清晰的层级结构
- 可复用的组件样式
- 易于维护的变量系统

### 版本控制
- 记录重要的样式变更
- 保持向后兼容性
- 渐进式的样式升级
- 完整的变更文档

---

**总结**: 本次改进成功优化了PageMiner插件的页面布局，让界面更加紧凑美观，并设计了一套完整统一的消息框组件系统。通过减少不必要的空白空间、优化组件尺寸、统一设计风格，显著提升了插件的视觉表现和用户体验。新的消息框组件完全替代了原生的prompt和confirm，提供了更美观、更易用、更一致的交互体验。


# PageMiner 规则布局改进总结

## 🎯 改进目标

本次改进旨在优化ruleManager页面的规则卡片布局，让规则名称和key占据更多空间，ID长度较小，并将启用/停用开关和三个字段放在同一行，提升布局的合理性和美观性。

## ✨ 改进内容

### 1. **规则头部布局优化** ✅ 已完成
- **网格布局调整**: 从 `grid-template-columns: 1fr 1fr auto` 改为 `grid-template-columns: auto 1fr 1fr auto`
- **ID字段**: 固定宽度80px，居中对齐，不再占用过多空间
- **规则名称**: 占据更多空间，便于输入长名称
- **规则Key**: 占据更多空间，便于输入长标识符
- **开关位置**: 放在最右侧，与三个字段在同一行

### 2. **字段布局优化** ✅ 已完成
- **字段名称**: 最小宽度120px，确保有足够空间
- **选择器文本**: 弹性宽度，占据剩余空间
- **删除按钮**: 固定尺寸，不占用过多空间
- **整体对齐**: 所有字段在同一行，布局整齐

### 3. **响应式设计优化** ✅ 已完成
- **桌面端**: 四列网格布局，ID、名称、Key、开关
- **平板端**: 保持四列布局，适当调整间距
- **移动端**: 单列布局，ID居中显示，确保可读性

## 🔧 具体改进细节

### 规则头部CSS
```css
.rule-header {
  display: grid;
  grid-template-columns: auto 1fr 1fr auto;
  gap: 16px;
  margin-bottom: 16px;
  align-items: center;
}
```

### ID字段样式
```css
.rule-id {
  width: 80px;
  text-align: center;
  flex-shrink: 0;
  /* 其他样式保持不变 */
}
```

### 开关样式优化
```css
.switch {
  flex-shrink: 0;
  /* 确保开关不会被压缩 */
}
```

## 📱 响应式断点

### 桌面端 (> 768px)
- 四列网格布局
- ID: 80px固定宽度
- 名称: 弹性宽度
- Key: 弹性宽度  
- 开关: 50px固定宽度

### 移动端 (≤ 768px)
- 单列布局
- ID居中显示
- 所有元素垂直排列
- 保持可读性和易用性

### 小屏移动端 (≤ 480px)
- 进一步优化间距
- 减小字体和内边距
- 确保触摸友好

## 🎨 视觉效果

### 布局优势
1. **空间利用更合理**: 规则名称和Key占据更多空间，便于输入
2. **视觉层次清晰**: ID字段较小，不会干扰主要内容
3. **操作便捷**: 开关和三个字段在同一行，操作更直观
4. **整体美观**: 网格布局整齐，视觉效果更好

### 交互体验
1. **输入友好**: 规则名称和Key有足够空间输入长文本
2. **状态清晰**: 开关状态一目了然
3. **操作直观**: 删除按钮位置明确，操作便捷
4. **响应迅速**: 悬停和焦点效果及时反馈

## 🚀 技术实现

### CSS Grid布局
- 使用现代CSS Grid实现精确的列宽控制
- 支持响应式断点，自动调整布局
- 保持元素对齐和间距一致性

### 弹性布局
- 关键字段使用弹性宽度，充分利用空间
- 固定宽度元素使用`flex-shrink: 0`防止压缩
- 确保在各种屏幕尺寸下都能正常显示

### 响应式设计
- 使用媒体查询实现断点切换
- 移动端优化触摸体验
- 保持设计风格的一致性

## 📋 测试验证

### 测试页面
创建了 `test_rule_layout.html` 测试页面，包含：
- 三个示例规则卡片
- 不同数量的字段
- 交互功能演示
- 响应式布局测试

### 测试内容
1. **桌面端布局**: 验证四列网格布局
2. **移动端适配**: 验证单列布局
3. **交互功能**: 验证开关、输入框、删除按钮
4. **视觉效果**: 验证悬停、焦点等状态

## 🔮 未来改进方向

### 功能增强
- 支持拖拽排序字段
- 批量编辑字段属性
- 字段类型选择器
- 验证规则配置

### 布局优化
- 支持自定义列宽
- 可折叠的字段列表
- 快速搜索和过滤
- 批量操作界面

### 用户体验
- 键盘快捷键支持
- 操作历史记录
- 智能提示系统
- 个性化布局设置

## 📝 维护说明

### 样式规范
- 遵循BEM命名规范
- 使用语义化的类名
- 保持样式的模块化
- 统一的注释风格

### 响应式策略
- 移动优先的设计理念
- 渐进式的功能增强
- 触摸友好的交互设计
- 性能优化的动画效果

---

**总结**: 本次改进成功优化了PageMiner插件的规则管理页面布局，通过调整网格列宽分配、优化ID字段显示、改善开关位置，让界面更加合理美观。新的布局在保持功能完整性的同时，显著提升了空间利用效率和用户体验。


# PageMiner 全站样式改进总结

## 🎯 改进目标

本次改进旨在统一PageMiner插件的整体设计风格，让所有页面都采用现代化、美观、友好的界面设计，提升用户体验。

## ✨ 改进范围

### 1. **overlay.js** ✅ 已完成
- 规则配置面板的现代化设计
- 字段+提取示例+规则的展示方式
- 隐藏复杂规则，显示用户友好的提取示例

### 2. **ruleManager** ✅ 已完成
- 规则管理页面的全面重构
- 现代化卡片式布局
- 优化的表单控件和交互体验

### 3. **viewDataManager** ✅ 已完成
- 数据查看页面的设计升级
- 优化的表格样式和分页控件
- 响应式布局和交互优化

### 4. **popup.html** ✅ 已完成
- 弹窗界面的完全重构
- 现代化渐变设计和动画效果
- 优化的按钮布局和视觉层次

## 🎨 统一设计风格

### 色彩方案
- **主色调**: 蓝色渐变 (#3b82f6 → #1d4ed8)
- **成功色**: 绿色渐变 (#10b981 → #059669)
- **危险色**: 红色渐变 (#ef4444 → #dc2626)
- **信息色**: 紫色渐变 (#8b5cf6 → #7c3aed)
- **中性色**: 灰色系 (#f8fafc, #e2e8f0, #64748b)

### 设计元素
- **圆角**: 8px-16px 统一圆角设计
- **阴影**: 多层次阴影系统，营造深度感
- **渐变**: 现代化渐变背景和按钮
- **动画**: 平滑过渡和悬停效果
- **图标**: 统一的emoji图标系统

### 字体系统
- **字体栈**: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto
- **字重**: 400(常规), 500(中等), 600(半粗), 700(粗体)
- **字号**: 12px-32px 的层次化字号系统

## 🔧 技术特性

### CSS特性
- **Flexbox/Grid**: 现代化布局系统
- **CSS变量**: 可维护的颜色和尺寸系统
- **动画**: CSS3 过渡和关键帧动画
- **响应式**: 移动端友好的响应式设计
- **滚动条**: 自定义滚动条样式

### 交互体验
- **悬停效果**: 按钮和卡片的悬停状态
- **焦点状态**: 输入框和按钮的焦点样式
- **加载状态**: 加载动画和状态指示
- **空状态**: 友好的空数据提示

## 📱 响应式设计

### 断点设置
- **桌面端**: > 1024px
- **平板端**: 768px - 1024px
- **移动端**: < 768px

### 适配策略
- 弹性布局和网格系统
- 字体大小和间距的响应式调整
- 按钮和控件的移动端优化
- 触摸友好的交互设计

## 🚀 性能优化

### 渲染优化
- 硬件加速的CSS动画
- 优化的阴影和模糊效果
- 合理的重绘和重排策略

### 用户体验
- 快速响应的交互反馈
- 流畅的动画过渡
- 直观的视觉层次

## 📋 具体改进内容

### ruleManager 页面
- 现代化卡片式布局
- 优化的表单控件样式
- 改进的开关按钮设计
- 响应式网格布局

### viewDataManager 页面
- 优化的表格样式
- 改进的分页控件
- 友好的空状态提示
- 优化的数据展示

### popup 弹窗
- 完全重构的界面设计
- 现代化渐变背景
- 丰富的动画效果
- 优化的按钮布局

## 🎯 用户体验提升

### 视觉层面
- 统一的品牌形象
- 清晰的信息层次
- 舒适的视觉间距
- 美观的配色方案

### 交互层面
- 直观的操作流程
- 即时的视觉反馈
- 友好的错误提示
- 便捷的快捷操作

### 功能层面
- 智能的默认值
- 自动的状态管理
- 便捷的批量操作
- 灵活的自定义选项

## 🔮 未来改进方向

### 功能增强
- 主题切换功能
- 自定义配色方案
- 更多的动画效果
- 高级交互组件

### 技术升级
- CSS-in-JS 方案
- 组件化设计系统
- 主题变量系统
- 动画性能优化

### 用户体验
- 个性化设置
- 快捷键支持
- 操作历史记录
- 智能提示系统

## 📝 维护说明

### 样式规范
- 遵循BEM命名规范
- 使用语义化的类名
- 保持样式的模块化
- 统一的注释风格

### 代码组织
- 按功能模块分组
- 清晰的层级结构
- 可复用的组件样式
- 易于维护的变量系统

### 版本控制
- 记录重要的样式变更
- 保持向后兼容性
- 渐进式的样式升级
- 完整的变更文档

---

**总结**: 本次改进成功统一了PageMiner插件的整体设计风格，所有页面都采用了现代化、美观、友好的界面设计。通过统一的设计语言、优化的交互体验和响应式布局，显著提升了插件的专业性和用户体验。


# PageMiner Overlay 界面改进说明

## 🎯 改进目标

本次改进旨在让规则页面展示更加友好、美观，并保持简约风格，同时优化用户体验。

## ✨ 主要改进内容

### 1. 界面设计优化
- **现代化设计**：采用圆角、阴影、渐变等现代UI元素
- **配色方案**：使用柔和的蓝色主题，提升视觉舒适度
- **字体优化**：采用系统字体栈，确保跨平台一致性
- **间距调整**：优化各元素间距，提升布局美观性

### 2. 字段展示方式改进
**之前**：字段+规则（直接显示CSS选择器）
```
产品名称: body > div:nth-of-type(1) > div:nth-of-type(2) > div:nth-of-type(1)
```

**现在**：字段+提取示例+规则（隐藏规则，显示实际值）
```
产品名称
iPhone 15 Pro Max
📋 查看规则
```

### 3. 新增功能特性
- **提取示例显示**：实时显示字段对应的实际内容
- **规则详情查看**：点击"查看规则"可查看完整CSS选择器
- **空状态提示**：未选择字段时显示友好的引导信息
- **悬停效果**：按钮和交互元素添加悬停动画

### 4. 用户体验提升
- **拖拽支持**：面板可自由拖拽到合适位置
- **响应式设计**：适配不同屏幕尺寸
- **视觉反馈**：输入框聚焦、按钮悬停等状态变化
- **信息层次**：清晰的信息层级，重要信息突出显示

## 🔧 技术实现

### 核心函数
- `getFieldExampleValue(selector)`：获取字段实际值
- `showRuleDetails(fieldName, selector)`：显示规则详情
- `updateFieldList()`：更新字段列表显示

### 样式系统
- 使用CSS变量和现代CSS特性
- 响应式布局和弹性盒子
- 平滑过渡动画
- 阴影和模糊效果

## 📱 界面预览

```
┌─────────────────────────────────────┐
│ 📋 提取规则配置                     │
├─────────────────────────────────────┤
│ 规则 Key                           │
│ [example.com________________]      │
│                                     │
│ 规则名称                           │
│ [电商产品页面________________]      │
├─────────────────────────────────────┤
│ 🎯 点击页面元素开始提取字段         │
│                                     │
│ 产品名称                           │
│ iPhone 15 Pro Max                  │
│ 📋 查看规则                        │
│                                     │
│ 产品价格                           │
│ ¥9999                              │
│ 📋 查看规则                        │
├─────────────────────────────────────┤
│ 💾 保存规则    ❌ 关闭             │
└─────────────────────────────────────┘
```

## 🚀 使用方法

1. **启动提取模式**：插件会自动显示规则配置面板
2. **选择页面元素**：点击需要提取的页面元素
3. **命名字段**：为每个字段输入合适的名称
4. **查看提取示例**：面板会实时显示字段的实际内容
5. **查看规则详情**：点击"查看规则"查看完整CSS选择器
6. **保存规则**：完成配置后点击保存

## 🎨 设计原则

- **简约性**：去除不必要的视觉元素，保持界面简洁
- **一致性**：统一的设计语言和交互模式
- **可用性**：清晰的信息层次和直观的操作流程
- **美观性**：现代化的视觉设计和流畅的动画效果

## 🔮 未来改进方向

- 支持字段拖拽排序
- 添加字段类型选择（文本、图片、链接等）
- 支持批量字段操作
- 添加规则验证和测试功能
- 支持自定义主题色彩

## 📝 注意事项

- 提取示例会自动截断过长的内容（超过50字符显示...）
- 规则详情提示框会在3秒后自动消失
- 面板支持拖拽，可移动到页面任意位置
- 所有样式使用CSS-in-JS方式注入，确保样式隔离


# PageMiner 国际化功能使用指南

## 概述

PageMiner 扩展已经实现了完整的国际化（i18n）支持，支持以下语言：
- 简体中文 (zh-CN) - 默认语言
- English (en-US)
- 日本語 (ja-JP)
- 한국어 (ko-KR)

## 功能特性

### 1. 自动语言检测
- 优先使用用户存储的语言设置
- 自动检测浏览器语言设置
- 支持语言代码匹配（如 zh-CN, en-US）

### 2. 语言切换器
- 支持下拉菜单、按钮组、选择器三种样式
- 显示国旗、语言代码、本地语言名称
- 实时语言切换，无需刷新页面

### 3. 完整的翻译覆盖
- 弹窗页面 (popup)
- 规则管理页面 (ruleManager)
- 数据展示页面 (viewDataManager)
- 通用组件和消息

## 使用方法

### 1. 在HTML中添加国际化标记

```html
<!-- 使用 data-i18n 属性标记需要翻译的元素 -->
<h1 data-i18n="ruleManager.title">📋 提取规则管理</h1>
<p data-i18n="ruleManager.description">管理和配置您的网页数据提取规则</p>

<!-- 按钮文本 -->
<button>
  🔄 <span data-i18n="ruleManager.refresh">刷新</span>
</button>
```

### 2. 在JavaScript中使用翻译函数

```javascript
import { t, onLanguageChange } from '../../utils/i18n/i18n.js';

// 基本翻译
const message = t('ruleManager.messages.ruleSaved');

// 带参数的翻译
const warning = t('ruleManager.messages.importWarning', { 
    type: '覆盖', 
    count: 5 
});

// 监听语言变更
onLanguageChange((language) => {
    console.log('语言已切换到:', language);
    applyTranslations();
});
```

### 3. 添加语言切换器

```html
<div id="languageSwitcher" class="language-switcher-container"></div>
```

```javascript
import LanguageSwitcher from '../../utils/i18n/languageSwitcher.js';

// 初始化语言切换器
const languageSwitcherContainer = document.getElementById('languageSwitcher');
new LanguageSwitcher(languageSwitcherContainer, {
    dropdownStyle: 'dropdown', // 'dropdown', 'buttons', 'select'
    showFlag: true,
    showNativeName: true,
    showEnglishName: false,
    onChange: (language) => {
        console.log('语言已切换到:', language);
        applyTranslations();
    }
});
```

## 翻译键结构

### 通用键 (common)
```javascript
common: {
    loading: '加载中...',
    success: '成功',
    error: '错误',
    confirm: '确认',
    cancel: '取消',
    // ... 更多通用翻译
}
```

### 弹窗页面 (popup)
```javascript
popup: {
    title: '🚀 PageMiner',
    subtitle: '网页数据采集自动化工具',
    extractButton: '编制提取逻辑',
    // ... 更多弹窗翻译
}
```

### 规则管理 (ruleManager)
```javascript
ruleManager: {
    title: '📋 提取规则管理',
    description: '管理和配置您的网页数据提取规则',
    messages: {
        ruleSaved: '规则保存成功',
        ruleDeleted: '规则删除成功',
        // ... 更多消息翻译
    }
    // ... 更多规则管理翻译
}
```

### 数据管理 (dataManager)
```javascript
dataManager: {
    viewDataTitle: '📊 查看数据提取',
    selectRule: '选择规则',
    messages: {
        refreshSuccess: '数据刷新成功',
        deleteConfirm: '确认删除当前规则的所有数据？',
        // ... 更多消息翻译
    }
    // ... 更多数据管理翻译
}
```

## 添加新语言

### 1. 创建语言包文件

在 `utils/i18n/` 目录下创建新的语言文件，例如 `fr-FR.js`：

```javascript
export default {
    common: {
        loading: 'Chargement...',
        success: 'Succès',
        error: 'Erreur',
        // ... 更多翻译
    },
    // ... 其他翻译键
};
```

### 2. 更新语言配置

在 `utils/i18n/i18n.js` 中添加新语言：

```javascript
export const SUPPORTED_LANGUAGES = {
    'zh-CN': { /* ... */ },
    'en-US': { /* ... */ },
    'ja-JP': { /* ... */ },
    'ko-KR': { /* ... */ },
    'fr-FR': {
        name: 'Français',
        nativeName: 'Français',
        flag: '🇫🇷',
        direction: 'ltr'
    }
};

export const LANGUAGE_DETECTION_PRIORITY = [
    'zh-CN',
    'en-US',
    'ja-JP',
    'ko-KR',
    'fr-FR'  // 添加新语言
];
```

## 最佳实践

### 1. 翻译键命名
- 使用点号分隔的层级结构
- 按功能模块组织翻译键
- 保持键名简洁明了

### 2. 参数化翻译
- 使用 `{paramName}` 格式定义参数
- 在调用时传入实际值
- 支持数字、字符串等类型参数

### 3. 错误处理
- 提供默认值作为备用
- 记录翻译失败的键名
- 优雅降级到默认语言

### 4. 性能优化
- 语言包缓存机制
- 按需加载语言包
- 避免重复翻译计算

## 故障排除

### 常见问题

1. **翻译不显示**
   - 检查 `data-i18n` 属性是否正确
   - 确认国际化系统已初始化
   - 验证翻译键是否存在

2. **语言切换器不工作**
   - 检查语言切换器容器ID
   - 确认语言切换器CSS已加载
   - 验证语言包文件路径

3. **翻译键缺失**
   - 在所有语言包中添加对应翻译
   - 检查键名拼写是否正确
   - 使用默认语言作为备用

### 调试技巧

```javascript
// 检查当前语言
console.log('当前语言:', getCurrentLanguage());

// 检查翻译键
console.log('翻译结果:', t('ruleManager.title'));

// 监听语言变更
onLanguageChange((language) => {
    console.log('语言变更:', language);
});
```

## 更新日志

- **v1.0.0**: 初始国际化实现
- **v1.1.0**: 添加规则管理和数据展示页面国际化
- **v1.2.0**: 完善语言切换器和样式
- **v1.3.0**: 添加日文和韩文支持

## 贡献指南

欢迎为国际化功能贡献翻译和改进建议：

1. Fork 项目仓库
2. 创建功能分支
3. 添加或改进翻译
4. 提交 Pull Request

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目 Issues: [GitHub Issues](https://github.com/your-repo/issues)
- 邮箱: your-email@example.com




# MessageBox 通用消息框组件系统

## 概述

PageMiner 通用消息框组件系统是一个功能强大、美观易用的消息提示解决方案，完全替代了原生的 `prompt`、`confirm` 和 `alert` 方法。经过优化后，提供了更好的用户体验和更丰富的功能。

## 🚀 主要特性

### ✨ 用户体验优化
- **美观的现代化UI设计** - 采用渐变色彩和圆角设计
- **流畅的动画效果** - 淡入淡出和滑动动画
- **响应式设计** - 完美适配移动端和桌面端
- **键盘友好** - 支持回车键确认，ESC键取消
- **自动聚焦** - 输入框自动获得焦点

### 🔧 功能增强
- **多种消息类型** - 确认框、输入框、选择框、提示框等
- **自定义验证** - 支持自定义输入验证规则
- **进度条对话框** - 显示操作进度
- **Toast提示** - 非阻塞的轻量级提示
- **加载提示** - 优雅的加载状态显示
- **多选支持** - 支持单选和多选模式

### 🛡️ 稳定性提升
- **错误处理** - 完善的错误提示和验证
- **内存管理** - 自动清理DOM元素，防止内存泄漏
- **防重复** - 防止重复显示相同消息
- **兼容性** - 支持现代浏览器

## 📦 安装和使用

### 导入组件
```javascript
import {
  confirm,
  prompt,
  alert,
  message,
  select,
  custom,
  progress,
  success,
  error,
  warning,
  info,
  showToastInfo,
  showLoading,
  hideLoading
} from './utils/messageBox.js';
```

### 基础用法
```javascript
// 确认框
const result = await confirm('确定要删除吗？', '删除确认');

// 输入框
const name = await prompt('请输入姓名：', '用户信息');

// 提示框
await alert('操作成功！', '提示');

// 选择框
const option = await select('请选择：', ['选项1', '选项2'], '选择操作');
```

## 🎯 API 详细说明

### confirm(message, title, options)
显示确认对话框

**参数：**
- `message` (string): 确认消息
- `title` (string): 对话框标题
- `options` (object): 配置选项
  - `confirmText` (string): 确认按钮文本，默认 "确认"
  - `cancelText` (string): 取消按钮文本，默认 "取消"
  - `type` (string): 按钮类型，可选 "warning"、"danger" 等
  - `icon` (string): 图标，默认 "⚠️"
  - `closeOnOverlayClick` (boolean): 是否允许点击遮罩关闭，默认 false

**返回值：** Promise<boolean>

**示例：**
```javascript
const result = await confirm('确定要删除这个文件吗？', '删除确认', {
  type: 'danger',
  confirmText: '删除',
  cancelText: '取消'
});

if (result) {
  console.log('用户确认删除');
} else {
  console.log('用户取消删除');
}
```

### prompt(message, title, options)
显示输入对话框

**参数：**
- `message` (string): 提示消息
- `title` (string): 对话框标题
- `options` (object): 配置选项
  - `defaultValue` (string): 默认值
  - `placeholder` (string): 占位符文本
  - `type` (string): 输入类型，支持 "text"、"email"、"password"、"textarea" 等
  - `required` (boolean): 是否必填，默认 false
  - `validator` (function): 自定义验证函数
  - `errorMsg` (string): 错误提示信息
  - `closeOnOverlayClick` (boolean): 是否允许点击遮罩关闭，默认 false

**返回值：** Promise<string|null>

**示例：**
```javascript
const email = await prompt('请输入邮箱地址：', '邮箱验证', {
  type: 'email',
  placeholder: 'example@domain.com',
  required: true,
  validator: (value) => {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(value);
  },
  errorMsg: '请输入有效的邮箱地址'
});
```

### select(message, options, title, config)
显示选择对话框

**参数：**
- `message` (string): 提示消息
- `options` (array): 选项数组，可以是字符串数组或对象数组 `{value, label}`
- `title` (string): 对话框标题
- `config` (object): 配置选项
  - `defaultValue` (string): 默认选中值
  - `multiple` (boolean): 是否支持多选，默认 false
  - `confirmText` (string): 确认按钮文本，默认 "确定"
  - `cancelText` (string): 取消按钮文本，默认 "取消"
  - `closeOnOverlayClick` (boolean): 是否允许点击遮罩关闭，默认 false

**返回值：** Promise<string|array|null>

**示例：**
```javascript
const options = [
  { value: 'js', label: 'JavaScript' },
  { value: 'ts', label: 'TypeScript' },
  { value: 'react', label: 'React' }
];

const result = await select('请选择技术栈：', options, '技术选择', {
  multiple: true,
  defaultValue: 'js'
});
```

### custom(options)
显示完全自定义的对话框

**参数：**
- `options` (object): 配置选项
  - `title` (string): 对话框标题
  - `content` (string): HTML内容
  - `buttons` (array): 按钮配置数组
  - `width` (string): 对话框宽度，默认 "400px"
  - `showClose` (boolean): 是否显示关闭按钮，默认 true
  - `closeOnOverlayClick` (boolean): 是否允许点击遮罩关闭，默认 true
  - `position` (string): 位置，可选 "center"、"top"，默认 "center"

**返回值：** Promise<any>

**示例：**
```javascript
const result = await custom({
  title: '自定义对话框',
  content: `
    <div style="text-align: center; padding: 20px;">
      <p>这是一个完全自定义的对话框</p>
      <p>您可以在这里放置任何HTML内容</p>
    </div>
  `,
  width: '500px',
  showClose: true,
  buttons: [
    {
      text: '取消',
      type: 'secondary',
      value: 'cancel'
    },
    {
      text: '确定',
      type: 'primary',
      value: 'confirm'
    }
  ]
});
```

### progress(message, title, options)
显示进度条对话框

**参数：**
- `message` (string): 进度消息
- `title` (string): 对话框标题
- `options` (object): 配置选项
  - `showCancel` (boolean): 是否显示取消按钮，默认 true
  - `cancelText` (string): 取消按钮文本，默认 "取消"
  - `onCancel` (function): 取消回调函数

**返回值：** 控制对象，包含以下方法：
- `update(percent)`: 更新进度百分比 (0-100)
- `close()`: 关闭对话框
- `setMessage(msg)`: 更新进度消息

**示例：**
```javascript
const progressDialog = progress('正在处理数据...', '数据处理', {
  showCancel: true,
  onCancel: () => {
    warning('操作已取消');
  }
});

// 更新进度
progressDialog.update(50);
progressDialog.setMessage('正在处理数据... 50%');

// 完成后关闭
progressDialog.close();
```

### Toast 提示方法

#### success(msg, duration)
显示成功提示
```javascript
success('操作成功！', 3000);
```

#### error(msg, duration)
显示错误提示
```javascript
error('操作失败！', 3000);
```

#### warning(msg, duration)
显示警告提示
```javascript
warning('请注意！', 3000);
```

#### info(msg, duration)
显示信息提示
```javascript
info('这是一条信息', 3000);
```

#### showToastInfo(msg, options)
显示自定义Toast提示
```javascript
showToastInfo('自定义消息', {
  type: 'success',
  duration: 3000,
  icon: '🎉'
});
```

### 加载提示

#### showLoading(message)
显示加载提示
```javascript
showLoading('正在加载数据...');
```

#### hideLoading()
隐藏加载提示
```javascript
hideLoading();
```

## 🎨 样式定制

### CSS 变量
组件使用标准的CSS类名，您可以通过CSS覆盖来定制样式：

```css
/* 自定义主题色 */
.pageMiner-messageBox-btn-primary {
  background: linear-gradient(135deg, #your-color, #your-dark-color);
}

/* 自定义圆角 */
.pageMiner-messageBox {
  border-radius: 16px;
}

/* 自定义阴影 */
.pageMiner-messageBox {
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
}
```

### 响应式设计
组件内置响应式设计，在小屏幕设备上自动调整布局：

- 移动端：按钮垂直排列，全宽显示
- 桌面端：按钮水平排列，居中显示
- 自适应：根据屏幕尺寸自动调整间距和大小

## 🔧 高级用法

### 表单验证
```javascript
const result = await prompt('请输入密码：', '密码设置', {
  type: 'password',
  required: true,
  validator: (value) => {
    if (value.length < 6) return false;
    if (!/[A-Z]/.test(value)) return false;
    if (!/[a-z]/.test(value)) return false;
    if (!/\d/.test(value)) return false;
    return true;
  },
  errorMsg: '密码必须包含大小写字母和数字，长度至少6位'
});
```

### 链式操作
```javascript
async function complexWorkflow() {
  try {
    // 第一步：确认操作
    const confirmResult = await confirm('是否开始执行任务？');
    if (!confirmResult) return;
    
    // 第二步：获取用户输入
    const taskName = await prompt('请输入任务名称：', '任务设置', {
      required: true
    });
    if (!taskName) return;
    
    // 第三步：显示进度
    const progressDialog = progress('正在执行任务...', '任务执行');
    
    // 执行任务...
    for (let i = 0; i <= 100; i += 20) {
      await new Promise(resolve => setTimeout(resolve, 500));
      progressDialog.update(i);
    }
    
    progressDialog.close();
    success(`任务 "${taskName}" 执行完成！`);
    
  } catch (err) {
    error('任务执行失败：' + err.message);
  }
}
```

### 自定义按钮动作
```javascript
const result = await custom({
  title: '用户信息编辑',
  content: '...',
  buttons: [
    {
      text: '保存',
      type: 'primary',
      value: 'save',
      action: async () => {
        // 执行保存逻辑
        const saved = await saveUserData();
        if (!saved) {
          error('保存失败');
          return false; // 阻止对话框关闭
        }
        return true; // 允许对话框关闭
      }
    }
  ]
});
```

## 🚨 注意事项

1. **异步操作**：所有对话框方法都返回Promise，需要使用 `await` 或 `.then()` 处理
2. **内存管理**：组件会自动清理DOM元素，但建议在页面卸载时调用 `messageBox.destroy()`
3. **样式冲突**：组件使用特定的CSS类名前缀，避免与页面样式冲突
4. **浏览器兼容**：支持现代浏览器，不支持IE11及以下版本

## 🔄 更新日志

### v2.0.0 (当前版本)
- ✨ 新增进度条对话框功能
- ✨ 新增快速提示方法 (success, error, warning, info)
- ✨ 新增关闭按钮支持
- ✨ 新增点击遮罩关闭控制
- ✨ 新增输入验证错误提示
- 🐛 修复CSS类名错误
- 🐛 修复内存泄漏问题
- 🎨 优化UI设计和动画效果
- 📱 改进移动端响应式设计

### v1.0.0
- 🎉 初始版本发布
- ✨ 基础对话框功能
- ✨ Toast提示功能
- ✨ 加载提示功能

## 📄 许可证

MIT License - 详见项目根目录的 LICENSE 文件

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个组件！

---

**PageMiner MessageBox 组件** - 让消息提示更优雅、更易用！
